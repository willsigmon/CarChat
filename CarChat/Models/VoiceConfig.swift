import Foundation

struct VoiceConfig: Codable, Sendable {
    var ttsEngine: TTSEngineType
    var sttEnabled: Bool
    var vadSilenceThreshold: Double
    var vadSilenceDuration: Double

    static let `default` = VoiceConfig(
        ttsEngine: .system,
        sttEnabled: true,
        vadSilenceThreshold: -40.0,
        vadSilenceDuration: 1.5
    )
}

enum TTSEngineType: String, Codable, Sendable, CaseIterable, Identifiable {
    case system
    case openAI
    case elevenLabs
    case humeAI
    case googleCloud
    case cartesia
    case amazonPolly
    case deepgram

    var id: String { rawValue }

    /// Keychain storage key for this TTS engine's API credentials
    var keychainKey: String {
        switch self {
        case .system: "carchat.tts.system"
        case .openAI: "carchat.apikey.openai"
        case .elevenLabs: "carchat.apikey.elevenlabs"
        case .humeAI: "carchat.apikey.humeai"
        case .googleCloud: "carchat.apikey.googlecloud"
        case .cartesia: "carchat.apikey.cartesia"
        case .amazonPolly: "carchat.apikey.polly.access"
        case .deepgram: "carchat.apikey.deepgram"
        }
    }

    /// Amazon Polly uses a second key (secret key) alongside the access key
    var secondaryKeychainKey: String? {
        switch self {
        case .amazonPolly: "carchat.apikey.polly.secret"
        default: nil
        }
    }

    var displayName: String {
        switch self {
        case .system: "System (AVSpeechSynthesizer)"
        case .openAI: "OpenAI"
        case .elevenLabs: "ElevenLabs"
        case .humeAI: "Hume AI (Expressive)"
        case .googleCloud: "Google Cloud TTS"
        case .cartesia: "Cartesia (Ultra-Fast)"
        case .amazonPolly: "Amazon Polly"
        case .deepgram: "Deepgram Aura"
        }
    }
}
